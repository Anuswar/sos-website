<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SOS</title>

    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
    />

    <!--=============== BOXICONS ===============-->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/boxicons@latest/css/boxicons.min.css"
    />

    <!--=============== FONT AWESOME ===============-->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
    />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css"
    />

    <!--=============== SEIPER BUNDLE ===============-->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css"
    />

    <style>
      @import url("https://fonts.googleapis.com/css2?family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&display=swap");

      html,
      body {
        margin: 0;
        padding: 0;
        height: 100%;
        font-family: "Ubuntu", sans-serif;
      }

      /*=============== SCROLL BAR ===============*/

      /* Add vendor prefixes */
      ::-webkit-scrollbar {
        --webkit-appearance: none;
      }
      ::-webkit-scrollbar:vertical {
        width: 11px;
      }
      ::-webkit-scrollbar:horizontal {
        height: 11px;
      }
      ::-webkit-scrollbar-thumb {
        border-radius: 8px;
        border: 2px solid white;
        background-color: blue;
      }
      ::-webkit-scrollbar-thumb:hover {
        background-color: rgba(0, 0, 0, 0.5);
      }
      ::-webkit-scrollbar-track {
        background-color: #fff;
        border-radius: 8px;
      }
      /* Use relative units */
      ::-webkit-scrollbar {
        width: 1rem;
        height: 1rem;
      }
      ::-webkit-scrollbar-thumb {
        border-width: 0.2rem;
        border-radius: 1rem;
      }
      ::-webkit-scrollbar-track {
        border-radius: 1rem;
      }
      /* Use media queries */
      @media (max-width: 768px) {
        /* Define different styles for mobile devices */
        ::-webkit-scrollbar {
          width: 0.5rem;
          height: 0.5rem;
        }
        ::-webkit-scrollbar-thumb {
          border-width: 0.1rem;
          border-radius: 0.5rem;
        }
        ::-webkit-scrollbar-track {
          border-radius: 0.5rem;
        }
      }

      .container {
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
      }

      #map,
      #place,
      #aid,
      #info {
        flex-grow: 1;
        width: 100%;
        height: 100%;
      }

      .tabb {
        position: fixed;
        bottom: -13px;
        min-width: 400px;
        height: auto;
        z-index: 1000;
        user-select: none;
        display: flex;
        justify-content: center;
        margin: 10px;
      }

      .tabb .menuToggle {
        position: absolute;
        top: -30px;
        left: 50%;
        transform: translateX(-50%);
        width: 60px;
        height: 60px;
        padding: 10px;
        background: red;
        z-index: 1001;
        border-radius: 50%;
        cursor: pointer;
        display: flex;
        justify-content: center;
        align-items: center;
        color: #fff;
        font-size: 2em;
        font-weight: 600;
      }

      .tabb ul.menu {
        inset: 0;
        height: 40px;
        background: #fff;
        border-radius: 10px;
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
        gap: 55px;
        padding: 10px;
        box-shadow: 0 15px 25px rgba(0, 0, 0, 0.1);
      }

      .tabb ul.menu li {
        list-style: none;
      }

      .tabb ul.menu li a {
        display: flex;
        flex-direction: column;
        align-items: center;
        text-decoration: none;
        color: #000;
        font-size: 0.9em;
      }

      .tabb ul.menu li a i {
        font-size: 1.5em;
        pointer-events: none;
      }

      .tabb ul.menu li p {
        margin-top: 5px;
      }

      .tabb ul.menu li a.active {
        /* Add your active styles here */
        color: blue;
      }

      .tabbar-icon2 {
        display: none;
      }

      .tabb ul.menu li a.active .tabbar-icon1 {
        display: none;
      }
      .tabb ul.menu li a.active .tabbar-icon2 {
        display: none;
      }
      .tabb ul.menu li a.active .tabbar-icon2 {
        display: block;
      }

      .leaflet-container .leaflet-control-attribution {
        display: none;
      }

      /* CSS styles for the hospital list */
      #place #hospital-list,
      #place #police-station-list,
      #place #atm-mission-list,
      #place #petrol-pump-list {
        list-style-type: none;
        padding: 0;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }

      #place #hospital-list li,
      #place #police-station-list li,
      #place #atm-mission-list li,
      #place #petrol-pump-list li {
        background-color: #f5f5f5;
        border-radius: 8px;
        padding: 16px;
        margin: 10px 10px 19px 10px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        text-align: left;
      }

      @media screen and (max-width: 576px) {
        #place #hospital-list,
        #place #police-station-list,
        #place #atm-mission-list,
        #place #petrol-pump-list {
          align-items: inherit;
          width: 100%;
        }
      }

      @media screen and (min-width: 576px) {
        /* Adjust styles for screens wider than 576px */
        #place #hospital-list li,
        #place #police-station-list li,
        #place #atm-mission-list li,
        #place #petrol-pump-list li {
          display: inline-block;
          margin-right: 16px;
          margin-bottom: 16px;
          width: calc(50% - 16px);
        }
      }

      @media screen and (min-width: 992px) {
        /* Adjust styles for screens wider than 992px */
        #place #hospital-list li,
        #place #police-station-list li,
        #place #atm-mission-list li,
        #place #petrol-pump-list li {
          width: calc(33.33% - 16px);
        }
      }

      .wrapper12 {
        position: relative;
        overflow-x: hidden;
        border-radius: 13px;
        z-index: 1000;
      }
      .wrapper12 .icon {
        position: absolute;
        top: 0;
        height: 100%;
        width: 40px;
        display: flex;
        align-items: center;
      }
      .wrapper12 .icon:first-child {
        left: 0;
        display: none;
        background: linear-gradient(90deg, #dfe3ee 70%, transparent);
      }
      .wrapper12 .icon:last-child {
        right: 0;
        justify-content: flex-end;
        background: linear-gradient(-90deg, #dfe3ee 70%, transparent);
      }
      .wrapper12 .icon i {
        width: 55px;
        height: 55px;
        cursor: pointer;
        font-size: 1.2rem;
        text-align: center;
        line-height: 55px;
        border-radius: 50%;
      }
      .wrapper12 .icon i:hover {
        background: #efedfb;
      }
      .wrapper12 .icon:first-child i {
        margin-left: 1px;
      }
      .wrapper12 .icon:last-child i {
        margin-right: 1px;
      }
      .wrapper12 .tabs-box {
        display: flex;
        gap: 12px;
        padding: 0;
        padding-left: 10px;
        list-style: none;
        overflow-x: hidden;
        scroll-behavior: smooth;
      }
      .wrapper12 .tabs-box.dragging {
        scroll-behavior: auto;
        cursor: grab;
      }
      .wrapper12 .tabs-box .tab {
        cursor: pointer;
        font-size: 1.18rem;
        white-space: nowrap;
        background: #f5f4fd;
        padding: 13px 20px;
        border-radius: 30px;
        border: 1px solid #d8d5f2;
      }
      .wrapper12 .tabs-box .tab:hover {
        background: #efedfb;
      }
      .wrapper12 .tabs-box.dragging .tab {
        user-select: none;
        pointer-events: none;
      }
      .wrapper12 .tabs-box .tab.active-filter {
        color: #fff;
        background: blue;
        border-color: transparent;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div id="map"></div>
      <div style="display: none" id="place">
        <div class="wrapper12">
          <ul class="tabs-box">
            <li class="tab filter-item active-filter" data-filter="all">All</li>
            <li class="tab filter-item" data-filter="hospital">Hospital</li>
            <li class="tab filter-item" data-filter="Police">Police station</li>
            <li class="tab filter-item" data-filter="atm">AIM</li>
            <li class="tab filter-item" data-filter="petrol">Petrol pump</li>
          </ul>
        </div>

        <ul class="cards all hospital" id="hospital-list"></ul>
        <ul class="cards all Police" id="police-station-list"></ul>
        <ul class="cards all atm" id="atm-mission-list"></ul>
        <ul class="cards all petrol" id="petrol-pump-list"></ul>
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
      </div>
      <div style="display: none; background: yellow" id="aid"></div>
      <div style="display: none; background: wheat" id="info"></div>

      <div class="tabb">
        <div class="menuToggle">SOS</div>
        <ul class="menu">
          <li>
            <a href="#" id="nav-map" class="active">
              <i class="bx bx-home tabbar-icon1"></i>
              <i class="bx bxs-home tabbar-icon2"></i>
              <p>Home</p>
            </a>
          </li>
          <li>
            <a href="#" id="nav-place">
              <i class="bx bx-buildings tabbar-icon1"></i>
              <i class="bx bxs-buildings tabbar-icon2"></i>
              <p>Place</p>
            </a>
          </li>
          <li></li>
          <li>
            <a href="#" id="nav-aid">
              <i class="bx bx-conversation tabbar-icon1"></i>
              <i class="bx bxs-conversation tabbar-icon2"></i>
              <p>Aid</p>
            </a>
          </li>
          <li>
            <a href="#" id="nav-info">
              <i class="bx bx-user tabbar-icon1"></i>
              <i class="bx bxs-user tabbar-icon2"></i>
              <p>Info</p>
            </a>
          </li>
        </ul>
      </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>

    <script
      src="https://code.jquery.com/jquery-3.6.3.js"
      integrity="sha256-nQLuAZGRRcILA+6dMBOvcRh5Pe310sBpanc6+QBmyVM="
      crossorigin="anonymous"
    ></script>

    <script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>

    <script>
      /*=============== map ===============*/
      // Initialize Leaflet map
      var map = L.map("map");

      // Create a tile layer with OpenStreetMap data
      L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
        attribution:
          '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
      }).addTo(map);

      // Fetch user's location and display it on the map
      map.locate({ setView: true, maxZoom: 18 }); // Adjusted the maxZoom value

      function onLocationFound(e) {
        var marker = L.marker(e.latlng).addTo(map);
        marker.bindPopup("You are here!").openPopup();

        // Zoom in further to the user's location
        map.setView(e.latlng, 18);

        // Define the amenities and their respective classes
        var amenities = [
          { amenity: "hospital", className: "hospital" },
          { amenity: "police", className: "police-station" },
          { amenity: "atm", className: "atm-mission" },
          { amenity: "fuel", className: "petrol-pump" },
        ];

        // Fetch nearby amenities
        amenities.forEach(function (amenity) {
          var request = new XMLHttpRequest();
          var bounds = map.getBounds();
          var url =
            "https://www.overpass-api.de/api/interpreter?data=[out:json];node(around:1000," +
            e.latlng.lat +
            "," +
            e.latlng.lng +
            ")[amenity=" +
            amenity.amenity +
            "];out;";

          request.open("GET", url, true);
          request.onreadystatechange = function () {
            if (request.readyState === 4 && request.status === 200) {
              var elements = JSON.parse(request.responseText).elements;

              var placeDiv = document.getElementById("place");
              var list = document.getElementById(amenity.className + "-list");
              if (!list) {
                list = document.createElement("ul");
                list.id = amenity.className + "-list";
                placeDiv.appendChild(list);
              }

              elements.forEach(function (element) {
                var name =
                  element.tags.name ||
                  element.tags["name:en"] ||
                  element.tags["name:fr"] ||
                  element.tags.operator ||
                  "N/A";
                var latLng = L.latLng(element.lat, element.lon);
                var distance =
                  (e.latlng.distanceTo(latLng) / 1000).toFixed(2) +
                  " kilometers";
                var address =
                  element.tags["addr:full"] ||
                  element.tags["addr:housename"] ||
                  element.tags["addr:housenumber"] ||
                  element.tags["addr:street"] ||
                  element.tags["addr:postcode"] ||
                  element.tags["addr:city"] ||
                  element.tags["addr:country"] ||
                  "Address not available";
                var contact =
                  element.tags.phone ||
                  element.tags["contact:phone"] ||
                  element.tags.phone_1 ||
                  element.tags["phone:emergency"] ||
                  element.tags.email ||
                  element.tags.website ||
                  "Contact information not available";

                var listItem = document.createElement("li");
                listItem.classList.add(amenity.className);
                listItem.innerHTML =
                  "<strong>Name:</strong> " +
                  name +
                  "<br><strong>Address:</strong> " +
                  address +
                  "<br><strong>Contact:</strong> " +
                  contact +
                  "<br><strong>Distance:</strong> " +
                  distance;
                list.appendChild(listItem);
              });
            }
          };

          request.send();
        });
      }

      map.on("locationfound", onLocationFound);

      /*=============== menu ===============*/
      // Get all the <a> tags within the menu
      const menuLinks = document.querySelectorAll(".tabb ul.menu li a");

      // Get all the div elements
      const mapDiv = document.getElementById("map");
      const placeDiv = document.getElementById("place");
      const aidDiv = document.getElementById("aid");
      const infoDiv = document.getElementById("info");

      // Add click event listener to each <a> tag
      menuLinks.forEach(function (link) {
        link.addEventListener("click", function () {
          // Remove "active" class from all <a> tags
          menuLinks.forEach(function (link) {
            link.classList.remove("active");
          });

          // Add "active" class to the clicked <a> tag
          this.classList.add("active");

          // Hide all div elements
          mapDiv.style.display = "none";
          placeDiv.style.display = "none";
          aidDiv.style.display = "none";
          infoDiv.style.display = "none";

          // Show the corresponding div based on the clicked link
          if (this.id === "nav-map") {
            mapDiv.style.display = "block";
          } else if (this.id === "nav-place") {
            placeDiv.style.display = "block";
          } else if (this.id === "nav-aid") {
            aidDiv.style.display = "block";
          } else if (this.id === "nav-info") {
            infoDiv.style.display = "block";
          }
        });
      });

      /*=============== slide menu ===============*/
      $(document).ready(function () {
        // Variables for dragging
        var isDragging = false;
        var startX, scrollLeft;

        // Variables for long press
        var pressTimer;
        var scrollSpeed = 20;

        // Handle mousedown/touchstart event on tabs-box
        $(".tabs-box").on("mousedown touchstart", function (event) {
          // Set isDragging to true and record initial values
          isDragging = true;
          startX =
            event.type === "touchstart"
              ? event.touches[0].pageX - $(".tabs-box").offset().left
              : event.pageX - $(".tabs-box").offset().left;
          scrollLeft = $(".tabs-box").scrollLeft();

          // Set press timer to increase scroll speed if button is long pressed
          pressTimer = setTimeout(function () {
            scrollSpeed = 40; // Increase scroll speed
          }, 500); // Change time as needed
        });

        // Handle mousemove/touchmove event on tabs-box
        $(".tabs-box").on("mousemove touchmove", function (event) {
          // If isDragging is true, calculate the new scroll position and set it
          if (isDragging) {
            var mousePos =
              event.type === "touchmove"
                ? event.touches[0].pageX - $(".tabs-box").offset().left
                : event.pageX - $(".tabs-box").offset().left;
            var scrollPos = scrollLeft - (mousePos - startX);
            $(".tabs-box").scrollLeft(scrollPos);
          }
        });

        // Handle mouseup/touchend event on tabs-box
        $(".tabs-box").on("mouseup touchend", function () {
          isDragging = false;

          // Reset scroll speed and press timer
          scrollSpeed = 20;
          clearTimeout(pressTimer);
        });

        // Handle click event on filter items
        $(".filter-item").click(function () {
          const value = $(this).attr("data-filter");
          if (value == "all") {
            $(".cards").show("1000");
          } else {
            $(".cards")
              .not("." + value)
              .hide("1000");
            $(".cards")
              .filter("." + value)
              .show("cards");
          }
          // Add active class to clicked filter item
          $(this)
            .addClass("active-filter")
            .siblings()
            .removeClass("active-filter");
        });

        // Handle keydown event on wrapper12 to move left or right using keyboard
        $(".wrapper12").on("keydown", function (event) {
          // Check if wrapper12 is being hovered over
          if ($(this).is(":hover")) {
            // Move left if left arrow key is pressed
            if (event.keyCode === 37) {
              $(".tabs-box").animate({ scrollLeft: "-=" + scrollSpeed }, 100);
            }
            // Move right if right arrow key is pressed
            else if (event.keyCode === 39) {
              $(".tabs-box").animate({ scrollLeft: "+=" + scrollSpeed }, 100);
            }
          }
        });
      });
    </script>
  </body>
</html>
